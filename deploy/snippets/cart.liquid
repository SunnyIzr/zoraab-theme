<aside class="right-off-canvas-menu">
  <ul class="off-canvas-list">
    {% if cart.item_count > 0 %}
        <form action="/cart" method="post">
            <a class="button">Keep shopping</a>
            <input type="submit" name="checkout" value="Check out" class="button" />

            <h3>Total <em>{{ cart.total_price | money }}</em></h3>
            <h3><em>{{ cart.item_count | items }}</em> Items</h3>
            <h3>SHIPPING | Free</h3>
            <h3>Free shipping in the US.</h3>
            {% for item in cart.items %}    
        
              {% comment %}
              Determining the handle of the collection that was last seen for the 'continue shopping' link.
              {% endcomment %}
          
              {% if forloop.first %}
                {% assign collection_url = item.product.collections.first.url %}
                {% if collection_url == '/collections/frontpage' or collection_url == '' %}{% assign collection_url = '/collections/all' %}{% endif %}
              {% endif %}

              <tr>
                <td>
                  <a href="{{ item.product.url | within: collections.all }}">  
                    <img src="{{ item.product.featured_image.src | product_img_url: 'compact' }}" alt="{{ item.title | escape }}" />
                  </a>
                </td>
                <td>
                  <h2>
                    <a href="{{ item.product.url | within: collections.all }}">
                    {{ item.title }}
                    </a>
                  </h2>
                  {% comment %}
                  Line Item Properties
                  {% endcomment %}
                  {% if item.properties.size > 0 %}
                  <p>
                    {% for p in item.properties %}
                      {% unless p.last == blank %}
                        {{ p.first }}:
                        {% if p.last contains '/uploads/' %}
                          <a href="{{ p.last }}">{{ p.last | split: '/' | last }}</a>
                        {% else %}
                          {{ p.last }}
                        {% endif %}
                        <br />
                      {% endunless %}
                    {% endfor %}
                  </p>
                  {% endif %}
                  <h3>{{ item.vendor }}</h3>
                </td>
                <td>{{ item.price | money }}</td>
                <td>
                  <input type="number" name="updates[]" id="updates_{{ item.id }}" value="{{ item.quantity }}" />
                </td>
                <td>{{ item.line_price | money }}</td>
                <td>
                  <a href="/cart/change?line={{ forloop.index }}&quantity=0">Remove</a>
                </td>
              </tr>
            {% endfor %}
        
          
          {% comment %}
          For the checkout and update buttons to work, they need to use
          a name attribute set to 'checkout' and 'update', respectively. That's case-sensitive.
          {% endcomment %}
      
          <div>
            
            <span class="or">or</span>
            <input type="submit" name="update" value="Update cart" />
            <span class="or">or</span>
                
            {% comment %}Paypal and Google checkout buttons{% endcomment %}
            {% if additional_checkout_buttons %}
            <p class="additional-checkout-buttons">
              {{ content_for_additional_checkout_buttons }}
            </p>
            {% endif %}    
          </div>
      
          {% comment %}
          For the special instructions to be submitted with order,
          they need to use a name attribute set to 'note'. That's case-sensitive.
          {% endcomment %}
          <div>
            <p>Special instructions for seller</p>
            <textarea name="note">{{ cart.note }}</textarea>
          </div>

        </form>

    {% else %}

        <div>
          <h2>It appears that your cart is currently empty!</h2>
          <h3>You can continue browsing <a href="/collections/all">here</a>.</h3>
        </div>

    {% endif %}
  </ul>
</aside>
